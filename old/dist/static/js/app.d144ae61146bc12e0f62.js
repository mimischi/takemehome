webpackJsonp([1],{NHnr:function(t,e,n){"use strict";function i(t){n("oUfB")}function r(t){n("mGnn")}Object.defineProperty(e,"__esModule",{value:!0});var a=n("/5sW"),s=n("3EgV"),o=n.n(s),l=(n("QCv7"),{name:"app",data:function(){return{title:"TAKE.ME.HOME.",drawer:null}}}),u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",{attrs:{light:"light"}},[n("v-toolbar",{attrs:{color:"blue",dark:"dark",fixed:"fixed",app:"app"}},[n("v-toolbar-title",{domProps:{textContent:t._s(t.title)}}),n("v-spacer"),n("v-toolbar-items",[n("v-btn",{attrs:{flat:"flat",to:"/"}},[t._v("HOME")]),n("v-btn",{attrs:{flat:"flat",to:"/departures"}},[t._v("Departures")])],1)],1),n("v-content",[n("v-container",{attrs:{fluid:"fluid"}},[n("v-fade-transition",{attrs:{mode:"out-in"}},[n("router-view")],1)],1)],1)],1)},c=[],d={render:u,staticRenderFns:c},p=d,m=n("VU/8"),f=m(l,p,!1,null,null,null),h=f.exports,v=n("/ocq"),g=n("mtWM"),_=n.n(g),b=_.a.create({timeout:1e4,baseURL:void 0}),S=b,x={name:"DepartureSearch",props:["stationSelect","label","icon"],data:function(){return{loading:!1,items:[],search:null,select:this.stationSelect||{name:"",extId:null},stations:[]}},watch:{search:function(t){t&&this.querySelections(t)},"select.name":function(t){var e=this.stations.find(this.getExtId);void 0!==e?(this.select.extId=e.StopLocation.extId,this.$emit("madeSelection",this.select)):void 0===e&&(this.select.extId=null,this.$emit("resetSelection"))}},methods:{filterStations:function(t){return t.filter(function(t){if(void 0!==t.StopLocation)return t})},getExtId:function(t){if(void 0!==t.StopLocation)return t.StopLocation.name===this.select.name},querySelections:function(t){var e=this;this.loading=!0,S.post("/",{url:"location.name",params:{input:t}}).then(function(t){e.stations=t.data.stopLocationOrCoordLocation,e.items=e.filterStations(e.stations).map(function(t){return t.StopLocation.name}),e.loading=!1}).catch(function(t){e.stations=t})}}},D=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-layout",{attrs:{row:"row"}},[n("v-flex",{attrs:{xs12:"xs12"}},[n("v-select",{attrs:{label:t.label,"prepend-icon":t.icon,autocomplete:"autocomplete",loading:t.loading,items:t.items,"search-input":t.search,clearable:"clearable"},on:{"update:searchInput":function(e){t.search=e}},model:{value:t.select.name,callback:function(e){t.$set(t.select,"name",e)},expression:"select.name"}})],1)],1)},L=[],y={render:D,staticRenderFns:L},w=y,T=n("VU/8"),I=T(x,w,!1,null,null,null),k=I.exports,E=n("fZjL"),$=n.n(E),C={name:"Timeline",props:["trip"],computed:{connectionDelayed:function(t,e){var n=new Date(t.date+" "+t.time),i=new Date(t.rtDate+" "+t.rtTime);return void 0!==e.Product&&(n.getTime()!==i.getTime()&&(i.getTime()-n.getTime())/1e3)},delayedClass:function(t,e){return this.connectionDelayed(t,e)?"delayed":""},departureTime:function(t,e){if(void 0===e.Product)return t.time.substring(0,5);var n=this.connectionDelayed(t,e);if(void 0!==t.rtTime&&n){var i=n%3600/60;return t.rtTime.substring(0,5)+" (+"+i+"m)"}return t.time.substring(0,5)},LegListLength:function(){return $()(this.trip.LegList.Leg).length-1},productType:function(t){var e="directions_railway";if(void 0===t.Product)return"directions_walk";var n=t.Product.catOutL;return n.startsWith("U-Bahn")?e="directions_subway":n.startsWith("Niederflurbus")?e="directions_bus":n.startsWith("Niederflurstraßenbahn")&&(e="tram"),e},formatDuration:function(t){var e=t.split(/P|T|H|M/),n=void 0,i=void 0;return 5===e.length?(n=e[2],i=e[3]):(n=0,i=e[2]),n<10&&(n="0"+n),i<10&&(i="0"+i),n+"h"+i+"m"}}},M=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-slide-y-transition",[n("v-flex",{attrs:{xs12:"xs12"}},[n("ul",{staticClass:"timeline"},[n("span",{attrs:{"data-icon":"timer"}},[t._v(t._s(t.$options.computed.formatDuration(t.trip.duration)))]),n("span",{attrs:{"data-icon":"autorenew"}},[t._v(t._s(t.LegListLength))]),t._l(t.trip.LegList.Leg,function(e){return n("li",{key:t.trip.tripId,staticClass:"event",attrs:{"data-icon":t.$options.computed.productType(e)}},["JNY"===e.type?n("h3",[t._v(t._s(e.Product.name)+" - "+t._s(e.direction))]):"WALK"===e.type?n("h3",[t._v("Walk to "+t._s(e.Destination.name))]):t._e(),n("p",{class:t.$options.computed.delayedClass(e.Origin,e)},[t._v(t._s(t.$options.computed.departureTime(e.Origin,e))+" - "+t._s(e.Origin.name))]),n("p",{class:t.$options.computed.delayedClass(e.Destination,e)},[t._v(t._s(t.$options.computed.departureTime(e.Destination,e))+" - "+t._s(e.Destination.name))])])})],2)])],1)},P=[],U={render:M,staticRenderFns:P},O=U,B=n("VU/8"),F=i,R=B(C,O,!1,F,"data-v-51185cea",null),W=R.exports,H={name:"TimelineSkeleton",props:["trip"],data:function(){return{num:3}}},V=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-slide-y-transition",[n("v-flex",{attrs:{xs12:"xs12"}},t._l(t.num,function(e){return n("ul",{staticClass:"timeline"},[n("li",{staticClass:"event"},[n("h3",[t._v(" ")]),n("p",[t._v(" ")]),n("p",[t._v(" ")])])])}))],1)},A=[],N={render:V,staticRenderFns:A},q=N,K=n("VU/8"),j=r,G=K(H,q,!1,j,"data-v-0885a828",null),J=G.exports,Q={name:"Connection",components:{DepartureSearch:k,Timeline:W,TimelineSkeleton:J},data:function(){return{loading:!1,dialog:!1,alert:!1,disabled:!1,errors:null,stations:{start:{name:"",extId:null},end:{name:"",extId:null}},trips:null}},watch:{"stations.start":function(t){this.toggleSubmitButton()},"stations.end":function(t){this.toggleSubmitButton()}},mounted:function(){this.toggleSubmitButton()},computed:{showSkeleton:function(){return!this.trip&&this.loading}},methods:{toggleSubmitButton:function(){null===this.stations.start.extId||null===this.stations.end.extId?this.disabled=!0:this.disabled=!1},setDepartureStation:function(t){this.stations.start=t},resetDepartureStation:function(){this.stations.start={extId:null,name:""}},setDestinationStation:function(t){this.stations.end=t},resetDestinationStation:function(){this.stations.end={extId:null,name:""}},getTrip:function(){var t=this;this.loading=!0,this.disabled=!0,this.trips=null,this.errors=null,this.alert=!1,S.post("/",{url:"trip",params:{originExtId:this.stations.start.extId,destExtId:this.stations.end.extId}}).then(function(e){t.loading=!1,t.disabled=!1,t.trips=e.data.Trip}).catch(function(e){t.loading=!1,t.disabled=!1,t.alert=!0,t.errors='Something went wrong with the API: "'+e+'".'})}}},Y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-content",[n("departure-search",{attrs:{label:"What place do you want to leave?",icon:"flight_takeoff"},on:{madeSelection:t.setDepartureStation,resetSelection:t.resetDepartureStation}}),n("departure-search",{attrs:{label:"What is your destination?",icon:"flight_land"},on:{madeSelection:t.setDestinationStation,resetSelection:t.resetDestinationStation}}),n("v-btn",{attrs:{color:"primary",block:"block",large:"large",loading:t.loading,disabled:t.disabled},on:{click:t.getTrip}},[t._v("TAKE.ME.HOME")]),n("v-alert",{attrs:{color:"error",icon:"warning",value:t.errors,dismissible:"dismissible",transition:"scale-transition"},model:{value:t.alert,callback:function(e){t.alert=e},expression:"alert"}},[t._v(t._s(t.errors))]),t.showSkeleton?n("timeline-skeleton"):t._e(),t._l(t.trips,function(e){return t.trips?n("timeline",{key:e.tripId,attrs:{trip:e}}):t._e()})],2)},Z=[],z={render:Y,staticRenderFns:Z},X=z,tt=n("VU/8"),et=tt(Q,X,!1,null,null,null),nt=et.exports,it=n("M4fF"),rt=n.n(it),at={name:"DepartureList",props:["departures"],data:function(){return{data:this.departures||[]}},filters:{formatLine:function(t,e){return t+" to "+e},formatTime:function(t){return"Departure: "+t}}},st=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.departures?n("v-list",{attrs:{"two-line":"two-line"}},[t._l(t.departures,function(e){return[n("v-list-tile",{key:e.name,on:{click:function(t){}}},["Bus"===e.name.substring(0,3)?n("v-list-tile-avatar",[n("v-icon",[t._v("directions_bus")])],1):n("v-list-tile-avatar",[n("v-icon",[t._v("train")])],1),n("v-list-tile-content",[n("v-list-tile-title",{domProps:{innerHTML:t._s(t.$options.filters.formatLine(e.name,e.direction))}}),n("v-list-tile-sub-title",{domProps:{innerHTML:t._s(t.$options.filters.formatTime(e.time))}})],1)],1)]})],2):t._e()},ot=[],lt={render:st,staticRenderFns:ot},ut=lt,ct=n("VU/8"),dt=ct(at,ut,!1,null,null,null),pt=dt.exports,mt={name:"Departures",components:{DepartureList:pt,DepartureSearch:k},data:function(){return{select:{name:"",extId:null},departures:"",errors:[],stations:[]}},watch:{start:function(){this.currentStation="You're still typing, aren't you?",this.getStation()}},methods:{setStation:function(t){this.select=t},resetDepartures:function(){this.departures="",this.select={extId:null,name:""}},getStation:rt.a.debounce(function(){var t=this;if(!this.start||0===this.start.length||!this.start.trim())return void this.resetForm();this.stations="Searching...",S.post("/",{url:"location.name",params:{input:this.start}}).then(function(e){t.stations=e.data.stopLocationOrCoordLocation,t.currentStation=t.stations[0].StopLocation}).catch(function(e){t.stations="Could not reach the API. "+e})},500),getDeparture:function(){var t=this;this.data&&(this.data=""),S.post("/",{url:"departureBoard",params:{extId:this.select.extId,rtMode:"REALTIME"}}).then(function(e){t.departures=e.data.Departure}).catch(function(e){t.errors.push(e)})}}},ft=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-content",[n("departure-search",{on:{madeSelection:t.setStation,resetSelection:t.resetDepartures}}),n("v-layout",{attrs:{row:"row"}},[n("v-btn",{attrs:{color:"primary",disabled:!t.select.extId},on:{click:function(e){e.preventDefault(),t.getDeparture(e)}}},[t._v("Show departures!")])],1),n("departure-list",{attrs:{departures:t.departures}})],1)},ht=[],vt={render:ft,staticRenderFns:ht},gt=vt,_t=n("VU/8"),bt=_t(mt,gt,!1,null,null,null),St=bt.exports;a.a.use(v.a);var xt=new v.a({routes:[{path:"/",name:"Connection",component:nt},{path:"/departures",name:"Departures",component:St}]});a.a.use(o.a),a.a.config.productionTip=!1,new a.a({el:"#app",router:xt,render:function(t){return t(h)}})},QCv7:function(t,e){},mGnn:function(t,e){},oUfB:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.d144ae61146bc12e0f62.js.map